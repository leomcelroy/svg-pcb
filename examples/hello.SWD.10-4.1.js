let header_SWD_4_1 = {"CLK":{"shape":"M -0.05 0.02500000000000001L 0.05 0.02500000000000001L 0.05 -0.024999999999999994L -0.05 -0.02500000000000001L -0.05 0.024999999999999994","pos":[-0.107,0.05],"layers":["F.Cu"],"index":1},"DIO":{"shape":"M -0.05 0.02500000000000001L 0.05 0.02500000000000001L 0.05 -0.024999999999999994L -0.05 -0.02500000000000001L -0.05 0.024999999999999994","pos":[0.107,0.05],"layers":["F.Cu"],"index":2},"RST":{"shape":"M -0.05 0.02500000000000001L 0.05 0.02500000000000001L 0.05 -0.024999999999999994L -0.05 -0.02500000000000001L -0.05 0.024999999999999994","pos":[-0.107,-0.05],"layers":["F.Cu"],"index":3},"GND":{"shape":"M -0.05 0.02500000000000001L 0.05 0.02500000000000001L 0.05 -0.024999999999999994L -0.05 -0.02500000000000001L -0.05 0.024999999999999994","pos":[0.107,-0.05],"layers":["F.Cu"],"index":4}};
let header_SWD = {"VCC":{"shape":"M -0.047 0.015000000000000005L 0.047 0.015000000000000005L 0.047 -0.014999999999999994L -0.047 -0.015000000000000005L -0.047 0.014999999999999994 M 0.047 -0.015L 0.04752349245053752 -0.014990862405286435L 0.04804634710616188 -0.014963460753897363L 0.0485679269490148 -0.0149178284305241L 0.049087596514400984 -0.014854021031123554L 0.04960472266500396 -0.014772116295183121L 0.05011867536226639 -0.014672214011007084L 0.050628828433995014 -0.014554435894139947L 0.05113456033725499 -0.014418925439074783L 0.051635254915624214 -0.014265847744427303L 0.05213030214988503 -0.014095389311788626L 0.052619098901238684 -0.013907757818501811L 0.053101049646137 -0.013703181864639013L 0.05357556720183616 -0.013481910694487504L 0.05404207344178836 -0.013244213892883903L 0.0545 -0.01299038105676658L 0.05494878896349807 -0.01272072144234639L 0.0553878935520612 -0.012435563588325625L 0.055816778784387094 -0.012135254915624212L 0.05623492212988487 -0.011820161304100829L 0.05664181414529809 -0.011490666646784671L 0.05703695909538287 -0.011147172382160913L 0.05741987555688496 -0.010790097005079767L 0.05779009700507977 -0.01041987555688496L 0.05814717238216091 -0.010036959095382873L 0.05849066664678467 -0.009641814145298088L 0.05882016130410083 -0.009234922129884873L 0.059135254915624214 -0.008816778784387098L 0.05943556358832563 -0.008387893552061201L 0.059720721442346386 -0.007948788963498073L 0.05999038105676658 -0.0075000000000000015L 0.060244213892883904 -0.007042073441788362L 0.0604819106944875 -0.006575567201836163L 0.060703181864639015 -0.006101049646137002L 0.06090775781850181 -0.005619098901238679L 0.06109538931178862 -0.005130302149885033L 0.0612658477444273 -0.004635254915624212L 0.06141892543907478 -0.0041345603372549885L 0.06155443589413995 -0.003628828433995021L 0.06167221401100709 -0.003118675362266392L 0.061772116295183116 -0.0026047226650039584L 0.06185402103112355 -0.002087596514400986L 0.0619178284305241 -0.0015679269490148015L 0.061963460753897366 -0.001046347106161881L 0.06199086240528644 -0.0005234924505375157L 0.062 -1.734723475976807e-18L 0.06199086240528644 0.0005234924505375105L 0.06196346075389736 0.0010463471061618775L 0.0619178284305241 0.0015679269490148015L 0.06185402103112356 0.0020875965144009807L 0.061772116295183116 0.002604722665003955L 0.06167221401100709 0.003118675362266385L 0.06155443589413995 0.003628828433995021L 0.06141892543907478 0.004134560337254987L 0.0612658477444273 0.004635254915624214L 0.06109538931178862 0.005130302149885031L 0.060907757818501815 0.005619098901238684L 0.060703181864639015 0.006101049646136999L 0.06048191069448751 0.006575567201836167L 0.06024421389288391 0.007042073441788359L 0.05999038105676658 0.007499999999999996L 0.05972072144234639 0.007948788963498071L 0.05943556358832563 0.0083878935520612L 0.059135254915624214 0.008816778784387094L 0.05882016130410083 0.009234922129884877L 0.05849066664678467 0.009641814145298088L 0.05814717238216091 0.010036959095382873L 0.05779009700507977 0.010419875556884953L 0.05741987555688496 0.010790097005079768L 0.05703695909538288 0.011147172382160914L 0.05664181414529809 0.011490666646784668L 0.05623492212988487 0.011820161304100824L 0.055816778784387094 0.01213525491562421L 0.0553878935520612 0.012435563588325621L 0.05494878896349807 0.01272072144234639L 0.0545 0.01299038105676658L 0.054042073441788366 0.013244213892883903L 0.053575567201836156 0.013481910694487505L 0.053101049646137 0.013703181864639011L 0.052619098901238684 0.013907757818501811L 0.05213030214988503 0.014095389311788623L 0.051635254915624214 0.014265847744427306L 0.051134560337255 0.014418925439074779L 0.050628828433995014 0.01455443589413994L 0.05011867536226639 0.01467221401100708L 0.04960472266500395 0.014772116295183123L 0.049087596514400984 0.01485402103112355L 0.04856792694901481 0.014917828430524097L 0.04804634710616188 0.014963460753897363L 0.04752349245053751 0.014990862405286437L 0.047 0.015L 0.04647650754946249 0.014990862405286437L 0.045953652893838126 0.014963460753897363L 0.045432073050985206 0.014917828430524097L 0.044912403485599016 0.01485402103112355L 0.04439527733499604 0.014772116295183123L 0.043881324637733615 0.014672214011007087L 0.043371171566004986 0.014554435894139947L 0.04286543966274502 0.014418925439074786L 0.042364745084375786 0.0142658477444273L 0.04186969785011497 0.014095389311788623L 0.041380901098761316 0.013907757818501811L 0.040898950353863005 0.013703181864639018L 0.040424432798163844 0.013481910694487505L 0.039957926558211634 0.013244213892883903L 0.0395 0.01299038105676658L 0.03905121103650193 0.01272072144234639L 0.0386121064479388 0.012435563588325628L 0.038183221215612906 0.012135254915624217L 0.037765077870115134 0.01182016130410083L 0.03735818585470191 0.011490666646784675L 0.03696304090461713 0.011147172382160914L 0.036580124443115036 0.010790097005079768L 0.03620990299492024 0.01041987555688496L 0.03585282761783909 0.01003695909538288L 0.03550933335321533 0.009641814145298095L 0.03517983869589917 0.00923492212988487L 0.03486474508437579 0.008816778784387101L 0.03456443641167438 0.00838789355206121L 0.034279278557653614 0.007948788963498078L 0.03400961894323343 0.007500000000000003L 0.0337557861071161 0.007042073441788362L 0.0335180893055125 0.006575567201836167L 0.033296818135360985 0.006101049646137006L 0.03309224218149819 0.005619098901238684L 0.03290461068821138 0.005130302149885042L 0.0327341522555727 0.004635254915624214L 0.03258107456092522 0.00413456033725498L 0.03244556410586005 0.003628828433995021L 0.03232778598899291 0.0031186753622663953L 0.032227883704816884 0.002604722665003955L 0.03214597896887644 0.0020875965144009703L 0.032082171569475904 0.0015679269490148015L 0.03203653924610264 0.001046347106161881L 0.03200913759471356 0.0005234924505375261L 0.032 1.734723475976807e-18L 0.03200913759471356 -0.0005234924505375209L 0.032036539246102634 -0.0010463471061618757L 0.032082171569475904 -0.0015679269490147963L 0.03214597896887644 -0.0020875965144009825L 0.03222788370481688 -0.0026047226650039498L 0.03232778598899291 -0.0031186753622663814L 0.03244556410586005 -0.0036288284339950124L 0.03258107456092522 -0.004134560337254994L 0.0327341522555727 -0.0046352549156242085L 0.03290461068821137 -0.005130302149885021L 0.03309224218149819 -0.005619098901238679L 0.03329681813536099 -0.006101049646137009L 0.0335180893055125 -0.006575567201836163L 0.03375578610711609 -0.007042073441788355L 0.03400961894323342 -0.0075000000000000015L 0.03427927855765361 -0.00794878896349807L 0.03456443641167437 -0.008387893552061194L 0.03486474508437579 -0.008816778784387094L 0.03517983869589918 -0.009234922129884877L 0.03550933335321533 -0.009641814145298088L 0.03585282761783908 -0.010036959095382866L 0.036209902994920225 -0.01041987555688495L 0.036580124443115036 -0.010790097005079761L 0.03696304090461713 -0.011147172382160914L 0.03735818585470191 -0.011490666646784668L 0.03776507787011512 -0.011820161304100824L 0.0381832212156129 -0.01213525491562421L 0.03861210644793879 -0.01243556358832562L 0.039051211036501915 -0.01272072144234638L 0.03949999999999999 -0.012990381056766576L 0.03995792655821164 -0.013244213892883903L 0.040424432798163844 -0.013481910694487507L 0.040898950353863 -0.013703181864639013L 0.041380901098761316 -0.013907757818501808L 0.04186969785011497 -0.014095389311788626L 0.042364745084375786 -0.014265847744427303L 0.042865439662745 -0.014418925439074779L 0.04337117156600498 -0.014554435894139945L 0.0438813246377336 -0.014672214011007082L 0.04439527733499603 -0.014772116295183118L 0.04491240348559901 -0.014854021031123554L 0.0454320730509852 -0.0149178284305241L 0.045953652893838126 -0.014963460753897364L 0.04647650754946249 -0.014990862405286435L 0.04699999999999999 -0.015","pos":[0.077,-0.1],"layers":["F.Cu"],"index":1},"DIO":{"shape":"M -0.047 0.015000000000000005L 0.047 0.015000000000000005L 0.047 -0.014999999999999994L -0.047 -0.015000000000000005L -0.047 0.014999999999999994","pos":[-0.077,-0.1],"layers":["F.Cu"],"index":2},"GND":{"shape":"M -0.047 0.015000000000000005L 0.047 0.015000000000000005L 0.047 -0.014999999999999994L -0.047 -0.015000000000000005L -0.047 0.014999999999999994","pos":[0.077,-0.05],"layers":["F.Cu"],"index":3},"CLK":{"shape":"M -0.047 0.015000000000000005L 0.047 0.015000000000000005L 0.047 -0.014999999999999994L -0.047 -0.015000000000000005L -0.047 0.014999999999999994","pos":[-0.077,-0.05],"layers":["F.Cu"],"index":4},"GND_1":{"shape":"M -0.047 0.015000000000000005L 0.047 0.015000000000000005L 0.047 -0.014999999999999994L -0.047 -0.015000000000000005L -0.047 0.014999999999999994","pos":[0.077,0],"layers":["F.Cu"],"index":5},"SWO":{"shape":"M -0.047 0.015000000000000005L 0.047 0.015000000000000005L 0.047 -0.014999999999999994L -0.047 -0.015000000000000005L -0.047 0.014999999999999994","pos":[-0.077,0],"layers":["F.Cu"],"index":6},"KEY":{"shape":"M -0.047 0.015000000000000005L 0.047 0.015000000000000005L 0.047 -0.014999999999999994L -0.047 -0.015000000000000005L -0.047 0.014999999999999994","pos":[0.077,0.05],"layers":["F.Cu"],"index":7},"NC":{"shape":"M -0.047 0.015000000000000005L 0.047 0.015000000000000005L 0.047 -0.014999999999999994L -0.047 -0.015000000000000005L -0.047 0.014999999999999994","pos":[-0.077,0.05],"layers":["F.Cu"],"index":8},"GND_2":{"shape":"M -0.047 0.015000000000000005L 0.047 0.015000000000000005L 0.047 -0.014999999999999994L -0.047 -0.015000000000000005L -0.047 0.014999999999999994","pos":[0.077,0.1],"layers":["F.Cu"],"index":9},"RST":{"shape":"M -0.047 0.015000000000000005L 0.047 0.015000000000000005L 0.047 -0.014999999999999994L -0.047 -0.015000000000000005L -0.047 0.014999999999999994","pos":[-0.077,0.1],"layers":["F.Cu"],"index":10}};


// commands:
//  - SHIFT+ENTER: render
//  - drap & drop file: kicad import


// constants
const width = .41 // board width
const height = .6 // board height
const x = 1 // x origin
const y = 1 // y origin
const zt = 0 // top z
const w = .015 // wire width
const mask = .004 // solder mask size
const border = 0.05 // rendering border


// board creation
let board = new PCB();

let interior = new Turtle().rectangle(width, height).translate([x+width/2, y+height/2]);
board.addShape("interior", interior);


// add parts
let J1 = board.add(header_SWD_4_1, {translate: [x+width/2+.005, y+.1], rotate: 180, name: 'J1 SWD'});
let J3 = board.add(header_SWD, {translate: [J1.posX, y+height-.19], rotate: -90, name: 'J3\ntarget'});


// add wires
board.wire([J3.pad("DIO"),
            [J1.padX("DIO")-.08,J3.padY("DIO")],
            [J1.padX("DIO")-.08,J1.padY("DIO")],
            J1.pad("DIO")], w)

board.wire([J3.pad("GND"),
            [J3.padX("GND"),J3.padY("GND")-.09],
            [J3.posX,J3.padY("GND")-.09],
            [J1.posX,J1.padY("GND")],
            J1.pad("GND")], w)

board.wire([J3.pad("CLK"),
            [J3.padX("CLK"),J3.padY("CLK")+.09],
            [J3.padX("RST")+.08,J3.padY("CLK")+.09],
            [J3.padX("RST")+.08,J1.padY("CLK")],
            J1.pad("CLK")], w)

board.wire([J3.pad("GND_1"),
            [J1.posX,J1.padY("GND")],
            J1.pad("GND")], w)

board.wire([J3.pad("GND_2"),
            [J3.padX("GND_2"),J3.padY("GND_2")-.09],
            [J3.posX,J3.padY("GND")-.09],
            [J1.posX,J1.padY("GND")],
            J1.pad("GND")], w)

board.wire([J3.pad("RST"),
            [J3.padX("RST")+.05,J3.padY("RST")],
            [J3.padX("RST")+.05,J1.padY("RST")],
            J1.pad("RST")], w)


// rendering
return {
  shapes: [
    { d: board.getLayer("interior"), color: [0, 0, 0, 1] },
    { d: board.getLayer("B.Cu"), color: [0.0, 1.0, 0.5, .5] },
    { d: board.getLayer("F.Cu"), color: [0.7, .5, 0.29, .7] },
    { d: board.getLayer("drill"), color: [0.3, 0.7, 1, 0.9]},
    { d: board.getLayer("padLabels"), color: [1, 0.27, 0.07, .8] },
    { d: board.getLayer("componentLabels"), color: [0.1, 1, 0.1, .7] },
  ],
  limits: {
    x: [x-border, x+width+border],
    y: [y-border, y+height+border]
  },
  mm_per_unit: 25.4
}
